---
title: "Airline Loyalty Causal Inference"
subtitle: "By: Rebecca Hull"
format:
  revealjs:
    self-contained: false
resources:
  - ../figures/
license: "CC BY-SA 4.0"
---

## Motivation

I've always LOVED airplanes. 

I'm investigating how attaining a loyalty card status with an airline impacts CLV. **Customer Lifetime Value (CLV)** is calculated as the total revenue generated by a customer from flight bookings throughout their membership period. Basically, it represents the expected total revenue from a given customer.

I believe that increasing your loyalty card status increases CLV.

## Business Problem and Data

**Does getting a higher loyalty card status (Star or Nova) cause an increase in CLV?**

The Airline Loyalty dataset is a simulated dataset that comes from Kaggle and contains information such as loyalty card type, CLV, salary, education level, marital status, total flights, and enrollment year/month. Everyone in the dataset has one of three loyalty cards. The card status order is: Aurora < Nova < Star.

## Executive Summary

People with higher-tier cards (Nova or Star) have **lower** CLV than similar people with Aurora cards.

## Data Structure

![](data_structure.png){width=100%}


## Exploratory Data Analysis

![](clv_histogram.png){width=100%}

## Exploratory Data Analysis

![](enrollment_type_bar_chart.png){width=100%}

## Exploratory Data Analysis

![](loyalty_card_distribution_bar_chart.png){width=100%}

## Exploratory Data Analysis

![](salary_histogram.png){width=100%}

## DAG

![](DAG_CLV.jpg){width=100%}


## Identification Strategy

In order to do causal inference and control for confounding variables, my model will need to include: Loyalty Card Status, CLV, Income, Travel Frequency, Company Marketing Strategy, and Customer Engagement. (These last 4 will need to be conditioned on.)

## Practice: Simulate Data and Recover Parameters

- Step 1: Import needed libraries.

- Step 2: Define variables and set them equal to a value.

- Step 3: Simulate predictors randomly using uniform distributions. Use predictors and parameter values to simulate the outcome in multiple linear regression format.

- Step 4: Create and train the linear regression model.

- Step 5: Have you recovered the parameters?

## Parameters I set matched what I got back

![](parameters.png){width=100%}


## Estimate My Causal Effects

What my code does:

- Defines a Bayesian regression model where CLV is predicted using the generated features.

- Uses normal priors for the intercept and regression coefficients.

- Uses a half-normal prior for the noise (sigma).

- Estimates the posterior distribution of model parameters using MCMC sampling.

- Summarizes the posterior distributions of parameters and plots the marginal posterior distributions.

## My Causal Effects
![](results_from_trial.png){width=100%}

## Conjoint Experiment through Survey

I ran a conjoint experiment through a survey using Discover Sawtooth Software. I was testing how desirable different package deals (with specified benefits) were for different loyalty cards. I got 33 responses. Here are my results:

##

![](Airline%20Loyalty%20Conjoint%20Survey%20-%20Ever%20been%20on%20a%20plane_%20Chart.png)

##

![](Airline%20Loyalty%20Conjoint%20Survey%20-%20Employed%20rn_%20Chart.png)

##

![](Airline%20Loyalty%20Conjoint%20Survey%20-%2018_plus_%20Chart.png)

##

![](Airline%20Loyalty%20Conjoint%20Survey%20-%20How%20often%20do%20you%20fly_%20Chart.png)

##

![](Airline%20Loyalty%20Conjoint%20Survey%20-%20Travel%20Reason_%20Chart.png)

##

![](Loyalty%20Card%20Package%20Options%20-%20Card%20Type%20Chart.png)

##

![](Loyalty%20Card%20Package%20Options%20-%20Benefit%201%20Chart.png)

##

![](Loyalty%20Card%20Package%20Options%20-%20Benefit%202%20Chart.png)

##

![](Loyalty%20Card%20Package%20Options%20-%20Price%20Chart.png)

##

![](Loyalty%20Card%20Package%20Options%20-%20Attribute%20importance%20Chart.png)

##

![](Airline%20Loyalty%20Conjoint%20Survey%20-%20Buy%20a%20card_%20Chart.png)

##

![](Airline%20Loyalty%20Conjoint%20Survey%20-%20Yearly%20Income%20Chart.png)

##

![](Airline%20Loyalty%20Conjoint%20Survey%20-%20Education%20Level%20Chart.png)

##

![](Airline%20Loyalty%20Conjoint%20Survey%20-%20Age%20Chart.png)

##

![](Airline%20Loyalty%20Conjoint%20Survey%20-%20Gender%20Chart.png)

##

![](Airline%20Loyalty%20Conjoint%20Survey%20-%20Married_%20Chart.png)


## Implement Diff-in-Diff Strategy with Synthetic Data
![](DiD1.png)


## Diff-in-Diff Results

Pre/post difference in control group = 3006.32

Pre/post difference in treatment group = 4935.59

Difference in differences = 1929.27

Those who upgraded to a higher loyalty status (aka got the treatment) had an increase of $1929.27 in CLV after they upgraded from an Aurora card to Nova or Star card.


## Matching Strategy

I implemented a matching strategy on the Airline Loyalty dataset using propensity scores to see if getting a higher loyalty card (Star or Nova) caused an increase in CLV. The result was surprising! Not only did it not increase CLV, it actually **decreased** CLV!

Average Treated CLV (upgrade to Nova or Star): $7,282.51

Average Matched Control CLV (Aurora): $10,817.40

**Estimated treatment effect on CLV: $-3,534.89**

## Matching Strategy Code

![](matching.png)

## Possible Reasons Behind the Results

- Card upgrades may be a **response to low CLV**, not the cause — companies might give better cards to underperforming customers to boost engagement.

- **Unobserved factors** like shopping frequency could still bias results, even with matching.

- **Aurora users might naturally have higher CLV**, possibly because they’re long-time or high-value customers who never needed an upgrade.

- If there are **very few Aurora members**, the matched control group could be small and skewed by outliers with unusually high CLV.


## Conclusion

People with higher-tier cards (Nova or Star) have **lower** CLV than similar people with Aurora cards. This is most likely due to a small percentage of Aurora members. Only 20.5% of the dataset customers had Aurora cards.